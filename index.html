<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù…Ø±ÙƒØ² Ù‚ÙŠØ§Ø¯Ø© Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª - Ø§Ù„Ø¹Ù‚ÙŠØ¯ Ù‚Ø§Ø¯Ø± v2.0</title>
    <style>
        :root { 
            --army-green: #3d441e; 
            --desert-yellow: #d4b483; 
            --led-green: #00ff41; 
            --danger-red: #ff3131; 
            --radio-blue: #88ccff; 
            --warning-orange: #ffaa00;
        }
        body { 
            background: #050505; 
            color: var(--led-green); 
            font-family: 'Segoe UI', Tahoma, sans-serif; 
            margin: 0; 
            display: flex; 
            height: 100vh; 
            overflow: hidden; 
        }
       
        #sidebar { 
            width: 380px; 
            background: #0a0c05; 
            border-left: 3px solid var(--army-green); 
            padding: 15px; 
            overflow-y: auto; 
            box-shadow: inset 0 0 30px #000;
        }
        #main-display { 
            flex-grow: 1; 
            display: flex; 
            flex-direction: column; 
            padding: 15px; 
            gap: 12px;
        }
       
        #terminal { 
            flex-grow: 1; 
            background: rgba(0, 10, 0, 0.96); 
            border: 2px solid #1a331a; 
            padding: 18px; 
            overflow-y: auto; 
            font-family: 'Consolas', monospace; 
            font-size: 0.92em; 
            line-height: 1.55; 
            border-radius: 8px; 
            box-shadow: inset 0 0 30px #00ff001a; 
        }
       
        #command-center { 
            display: grid; 
            grid-template-columns: repeat(3, 1fr); 
            gap: 14px; 
            background: #111; 
            padding: 18px; 
            border-radius: 12px; 
            border: 2px solid #333; 
            max-height: 420px; 
            overflow-y: auto; 
        }
        .command-section { 
            border: 2px solid #222; 
            padding: 14px; 
            border-radius: 8px; 
            background: #0d0d0d; 
        }
        .command-section h4 { 
            margin: 0 0 12px 0; 
            color: var(--desert-yellow); 
            font-size: 0.9em; 
            text-align: center; 
            border-bottom: 2px solid #444; 
            padding-bottom: 6px; 
        }
       
        .hero-card, .enemy-card { 
            border: 1px solid #222; 
            padding: 10px; 
            margin-bottom: 10px; 
            border-radius: 6px; 
            background: #151515; 
            transition: all 0.2s;
        }
        .hero-card:hover, .enemy-card:hover { border-color: var(--led-green); }
        .tag { 
            font-size: 0.72em; 
            padding: 3px 7px; 
            border-radius: 4px; 
            float: left; 
            font-weight: bold; 
            margin-bottom: 6px;
        }
        .tag-combat { background: var(--danger-red); color: #fff; animation: blink 800ms infinite; }
        .tag-dead { background: #555; color: #fff; }
        .tag-ready { background: var(--led-green); color: #000; }
        
        button { 
            background: #1a1a1a; 
            color: #ccc; 
            border: 1px solid #444; 
            padding: 11px 12px; 
            cursor: pointer; 
            font-size: 0.82em; 
            text-align: right; 
            width: 100%; 
            margin-bottom: 7px; 
            transition: all 0.25s; 
            border-radius: 5px; 
        }
        button:hover { 
            background: var(--army-green); 
            color: #fff; 
            border-color: var(--led-green); 
            transform: translateX(-3px);
        }
        .btn-danger { 
            border-color: var(--danger-red); 
            color: var(--danger-red); 
            font-weight: bold;
        }
        .btn-danger:hover { 
            background: var(--danger-red); 
            color: #fff; 
        }
        .radio-msg { color: var(--radio-blue); font-weight: bold; }
        .commander-voice { 
            color: #fff; 
            font-weight: bold; 
            background: #1a331a; 
            padding: 3px 8px; 
            border-radius: 4px; 
        }
        .low-health { animation: blink 600ms infinite; color: var(--danger-red); }
       
        @keyframes blink { 
            0% { opacity: 1; } 
            50% { opacity: 0.35; } 
            100% { opacity: 1; } 
        }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-thumb { background: var(--army-green); border-radius: 10px; }
       
        /* Ø®Ø±ÙŠØ·Ø© ØªÙƒØªÙŠÙƒÙŠØ© */
        #tactical-map {
            background: #111;
            padding: 12px;
            border-radius: 10px;
            border: 2px solid var(--army-green);
        }
        #map {
            display: grid;
            grid-template-columns: repeat(8, 42px);
            grid-template-rows: repeat(6, 42px);
            gap: 3px;
            background: #0a1f0a;
            padding: 8px;
            border: 3px solid #223322;
            border-radius: 6px;
            width: fit-content;
            margin: 0 auto;
        }
        .map-cell {
            width: 42px;
            height: 42px;
            background: #112211;
            border: 1px solid #334422;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            position: relative;
            cursor: pointer;
            transition: all 0.2s;
        }
        .map-cell:hover {
            background: #1a331a;
            transform: scale(1.08);
        }
        .map-cell .coord-label {
            position: absolute;
            bottom: 1px;
            right: 2px;
            font-size: 9px;
            color: #555;
            opacity: 0.6;
        }
        .resources-bar {
            display: flex;
            justify-content: space-around;
            background: #1a1a1a;
            padding: 10px 15px;
            border-radius: 8px;
            border: 1px solid #333;
            font-size: 0.9em;
        }
        .resource-item {
            text-align: center;
        }
        .resource-item span {
            font-weight: bold;
            font-size: 1.1em;
        }
    </style>
</head>
<body>
<div id="sidebar">
    <h3 style="text-align:center; color: var(--desert-yellow); border-bottom: 2px solid var(--army-green); padding-bottom: 12px; margin-bottom:12px;">Ø¯ÙØªØ± Ø£Ø­ÙˆØ§Ù„ Ø§Ù„Ù‚ÙˆØ© - Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø¨Ø±Ø«</h3>
    
    <div style="background:#1a1a1a; padding:10px; border-radius:6px; margin-bottom:15px;">
        <strong>Ø§Ù„Ù‚Ø§Ø¦Ø¯:</strong> Ø§Ù„Ø¹Ù‚ÙŠØ¯ Ø£.Ø­ / Ù‚Ø§Ø¯Ø±<br>
        <strong>Ø§Ù„Ù…Ù‡Ù…Ø©:</strong> Ø§Ù„Ø¯ÙØ§Ø¹ Ø¹Ù† Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø¨Ø±Ø« ÙˆØªØ·Ù‡ÙŠØ± Ø§Ù„Ù…Ø²Ø§Ø±Ø¹ Ø§Ù„Ø´Ø±Ù‚ÙŠØ©
    </div>
    
    <h4 style="color:var(--desert-yellow); margin:8px 0;">Ø§Ù„Ø£Ø¨Ø·Ø§Ù„ <span id="alive-count" style="color:var(--led-green);">(11/11)</span></h4>
    <div id="heroes-list"></div>
    
    <h4 style="color:#ff8888; margin:15px 0 8px 0;">Ø§Ø³ØªØ·Ù„Ø§Ø¹ Ø§Ù„Ø¹Ø¯Ùˆ</h4>
    <div id="enemies-list"></div>
</div>

<div id="main-display">
    <div style="display:flex; justify-content: space-between; align-items: center; background: #111; padding: 12px; border-radius: 10px; border:1px solid #333;">
        <div>
            Ø§Ù„Ù‚Ø§Ø¦Ø¯: <strong>Ø§Ù„Ø¹Ù‚ÙŠØ¯ Ø£.Ø­ / Ù‚Ø§Ø¯Ø±</strong> | 
            Ø§Ù„Ù…ÙˆÙ‚Ø¹: <strong>Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø¨Ø±Ø« - Ø§Ù„Ø®Ø· Ø§Ù„Ø£Ù…Ø§Ù…ÙŠ</strong>
        </div>
        <div id="combat-status" style="color: var(--led-green); font-weight: bold; font-size:1.05em;">[ Ø§Ù„Ø­Ø§Ù„Ø©: Ù‡Ø¯ÙˆØ¡ Ø­Ø°Ø± - Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªÙ…Ø±ÙƒØ² ]</div>
        <div style="display:flex; gap:25px; font-size:0.95em;">
            <div>Ø§Ù„Ø³Ø§Ø¹Ø©: <span id="clock">04:00:00</span></div>
            <div>ÙˆÙ‚Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ©: <span id="mission-timer">00:00</span></div>
        </div>
    </div>

    <!-- Ù…ÙˆØ§Ø±Ø¯ -->
    <div class="resources-bar">
        <div class="resource-item">Ø°Ø®ÙŠØ±Ø©: <span id="ammo-val" style="color:var(--led-green);">14,500</span> Ø·Ù„Ù‚Ø©</div>
        <div class="resource-item">Ø¥Ø³Ø¹Ø§Ù: <span id="med-val" style="color:var(--led-green);">52</span> Ø­Ù‚ÙŠØ¨Ø©</div>
        <div class="resource-item">ÙˆÙ‚ÙˆØ¯: <span id="fuel-val" style="color:var(--led-green);">92%</span></div>
        <div class="resource-item">Ù…Ø¹Ù†ÙˆÙŠØ§Øª: <span id="morale-val" style="color:var(--led-green);">88%</span></div>
    </div>

    <!-- Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø§Ù„ØªÙƒØªÙŠÙƒÙŠØ© -->
    <div id="tactical-map">
        <h4 style="margin:0 0 8px 0; color:var(--desert-yellow); text-align:center;">Ø®Ø±ÙŠØ·Ø© ØªÙƒØªÙŠÙƒÙŠØ© - Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø¨Ø±Ø« (Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø¹Ø³ÙƒØ±ÙŠØ© A-H / 1-6)</h4>
        <div id="map"></div>
        <small style="display:block; text-align:center; color:#666; margin-top:6px;">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø£ÙŠ Ø®Ù„ÙŠØ© Ù„Ù„Ø±ØµØ¯ Ø§Ù„ÙÙˆØ±ÙŠ â€¢ ğŸª– = Ø£Ø¨Ø·Ø§Ù„Ù†Ø§ â€¢ ğŸ‘¥ = Ø¹Ø¯Ùˆ</small>
    </div>

    <div id="terminal">
        <p style="color: #666;">[ ØªÙ… ØªØ´ÙÙŠØ± Ø§Ù„ØªØ±Ø¯Ø¯ 147.225 MHz.. Ø§ØªØµØ§Ù„ Ø¢Ù…Ù† Ù…Ø¹ Ø§Ù„Ù‚ÙŠØ§Ø¯Ø© Ø§Ù„Ø¹Ø§Ù…Ø© ÙˆØ§Ù„ÙˆØ­Ø¯Ø§Øª Ø§Ù„ÙØ±Ø¹ÙŠØ© ÙˆØ§Ù„Ø¯Ø±ÙˆÙ†Ø§Øª ]</p>
        <p style="color: #888;">[ 04:00:12 ] Ù…Ø±Ø­Ø¨Ø§Ù‹ ÙŠØ§ ÙÙ†Ø¯Ù…ØŒ ÙƒÙ„ Ø§Ù„ÙˆØ­Ø¯Ø§Øª ÙÙŠ Ø£Ù…Ø§ÙƒÙ†Ù‡Ø§. Ø¬Ø§Ù‡Ø²ÙŠÙ† Ù„Ù„Ø£ÙˆØ§Ù…Ø±.</p>
    </div>

    <div id="command-center">
        <!-- Ù‚Ø³Ù… 1 -->
        <div class="command-section">
            <h4>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ…Ø±ÙƒØ² ÙˆØ§Ù„ØªØ£Ù…ÙŠÙ†</h4>
            <button onclick="handleCmd('deploy')">Ù†Ø´Ø± Ø§Ù„Ø£Ø¨Ø·Ø§Ù„ Ø¹Ù„Ù‰ Ù†Ù‚Ø§Ø· Ø§Ù„Ø§Ø±ØªÙƒØ§Ø² Ø§Ù„Ø¯Ø§Ø¦Ù…Ø©</button>
            <button onclick="handleCmd('perimeter_scan')">ÙØ­Øµ Ø§Ù„Ù…Ø­ÙŠØ· Ø¨Ø§Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ù„ÙŠÙ„ÙŠØ© + ÙƒØ§Ù…ÙŠØ±Ø§Øª Ø­Ø±Ø§Ø±ÙŠØ©</button>
            <button onclick="handleCmd('thermal_check')">Ù…Ø³Ø­ Ø­Ø±Ø§Ø±ÙŠ ÙƒØ§Ù…Ù„ Ù„Ù„Ù…Ø²Ø§Ø±Ø¹ Ø§Ù„Ù€ 7 Ø§Ù„Ù…Ø­ÙŠØ·Ø©</button>
            <button onclick="handleCmd('fortify')">ØªØ¯Ø¹ÙŠÙ… Ø§Ù„Ø³ÙˆØ§ØªØ± Ø§Ù„Ø±Ù…Ù„ÙŠØ© + Ø£ÙƒÙŠØ§Ø³ Ø§Ù„Ø±Ù…Ø§Ù„ Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©</button>
            <button onclick="handleCmd('sniper_pos')">ØªØ«Ø¨ÙŠØª Ø§Ù„Ù‚Ù†Ø§ØµØ© Ø¹Ù„Ù‰ Ø£Ø³Ø·Ø­ Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ + Ø§Ù„Ø¨Ø±Ø¬ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ</button>
            <button onclick="handleCmd('mine_lay')">Ø²Ø±Ø¹ Ø£Ù„ØºØ§Ù… Ù…Ø¶Ø§Ø¯Ø© Ù„Ù„Ø¯Ø±ÙˆØ¹ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¯Ø§Ø®Ù„ Ø§Ù„Ø´Ø±Ù‚ÙŠØ©</button>
            <button onclick="handleCmd('civilian_check')">Ø¨Ù„Ø§Øº ØªØ­Ø±Ùƒ Ù…Ø¯Ù†ÙŠ Ù…Ø±ÙŠØ¨ + ÙØ­Øµ Ù‡ÙˆÙŠØ§Øª</button>
        </div>
        
        <!-- Ù‚Ø³Ù… 2 -->
        <div class="command-section">
            <h4>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø§Ø´ØªØ¨Ø§Ùƒ (Ø§Ù„Ù†ÙŠØ±Ø§Ù† Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø©)</h4>
            <button class="btn-danger" onclick="startBattle()">!!! Ø­Ø±Ø³ Ø³Ù„Ø§Ø­ - Ù‡Ø¬ÙˆÙ… Ø´Ø§Ù…Ù„ !!!</button>
            <button onclick="handleCmd('suppression')">Ù†ÙŠØ±Ø§Ù† ØªØºØ·ÙŠØ© ÙƒØ«ÙŠÙØ© Ø¨ÙƒÙ„ Ø§Ù„Ø£Ø³Ù„Ø­Ø© Ø§Ù„Ø«Ù‚ÙŠÙ„Ø© (Ø¬Ø±ÙŠÙ†ÙˆÙ + Ø¯ÙˆØ´ÙƒØ§)</button>
            <button onclick="handleCmd('rpg_volly')">Ø¯ÙØ¹Ø© RPG-7 + Ù‚Ø°Ø§Ø¦Ù SPG-9 Ø¹Ù„Ù‰ Ø§Ù„ØªØµÙÙŠØ­</button>
            <button onclick="handleCmd('target_snipers')">ØªØ­Ø¯ÙŠØ¯ ÙˆØªØ¯Ù…ÙŠØ± Ù‚Ù†Ø§ØµØ© Ø§Ù„Ø¹Ø¯Ùˆ Ø¨Ø§Ù„Ù‚Ù†Ø§ØµØ© Ø§Ù„Ø®Ø§ØµØ©</button>
            <button onclick="handleCmd('grenade_launch')">Ù‚Ø°Ù Ù‚Ù†Ø§Ø¨Ù„ ÙŠØ¯ÙˆÙŠØ© + Ù‚Ø°Ø§Ø¦Ù Ù‡Ø§ÙˆÙ† 60mm Ø®Ù„Ù Ø§Ù„Ø³ÙˆØ±</button>
            <button onclick="handleCmd('counter_attack')">Ù‡Ø¬ÙˆÙ… Ù…Ø¶Ø§Ø¯ ÙÙˆØ±ÙŠ Ù„ØªØ·Ù‡ÙŠØ± Ø§Ù„Ù…Ø¯Ø®Ù„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ</button>
            <button onclick="handleCmd('mortar_barrage')">Ø¶Ø±Ø¨Ø© Ù‡Ø§ÙˆÙ† 120mm Ù…Ø±ÙƒØ²Ø© Ø¹Ù„Ù‰ Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø¹Ø¯Ùˆ</button>
        </div>
        
        <!-- Ù‚Ø³Ù… 3 -->
        <div class="command-section">
            <h4>Ø§Ù„Ø¯Ø¹Ù… ÙˆØ§Ù„Ø¥Ù…Ø¯Ø§Ø¯ Ø§Ù„Ø¬ÙˆÙŠ + Ø§Ù„Ø¥Ø´Ø§Ø±Ø©</h4>
            <button onclick="handleCmd('air_strike')">Ø·Ù„Ø¨ Ø¶Ø±Ø¨Ø© Ø¬ÙˆÙŠØ© Ø¯Ù‚ÙŠÙ‚Ø© (F-16 / Mirage) - Ø­Ø¯Ø¯ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª</button>
            <button onclick="handleCmd('apache_cover')">Ø·Ù„Ø¨ ØºØ·Ø§Ø¡ Ø£Ø¨Ø§ØªØ´ÙŠ Ù…Ø³ØªÙ…Ø± Ù„Ù…Ø¯Ø© 20 Ø¯Ù‚ÙŠÙ‚Ø©</button>
            <button onclick="handleCmd('ammo_resupply')">Ø·Ù„Ø¨ Ø¥Ø³Ù‚Ø§Ø· Ø°Ø®ÙŠØ±Ø© Ø¹Ø§Ø¬Ù„ Ù…Ù† Ø·Ø§Ø¦Ø±Ø© Ø§Ù„Ù†Ù‚Ù„</button>
            <button onclick="handleCmd('reinforcements')">ØªØ­Ø±ÙŠÙƒ Ù‚ÙˆØ© Ø§Ù„ØªØ¯Ø®Ù„ Ø§Ù„Ø³Ø±ÙŠØ¹ (ÙƒØªÙŠØ¨Ø© 777) - 12 Ø¯Ù‚ÙŠÙ‚Ø©</button>
            <button onclick="handleCmd('jamming')">ØªØ´ÙˆÙŠØ´ ÙƒØ§Ù…Ù„ Ø¹Ù„Ù‰ ØªØ±Ø¯Ø¯Ø§Øª Ø§Ù„Ø¹Ø¯Ùˆ + Ø§Ù„Ù€ VHF</button>
            <button onclick="handleCmd('drone_scan')">ØªØ´ØºÙŠÙ„ Ø¯Ø±ÙˆÙ† Ø§Ø³ØªØ·Ù„Ø§Ø¹ÙŠ - ØµÙˆØ± Ø­ÙŠØ© + ØªØ­Ø¯ÙŠØ¯ Ø£Ù‡Ø¯Ø§Ù</button>
        </div>
        
        <!-- Ù‚Ø³Ù… 4 -->
        <div class="command-section">
            <h4>Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø·Ø¨ÙŠ ÙˆØ§Ù„Ø´Ù‡Ø¯Ø§Ø¡ + Ø§Ù„Ù…Ø¹Ù†ÙˆÙŠØ§Øª</h4>
            <button class="btn-danger" onclick="handleCmd('evac_injured')">Ø·Ù„Ø¨ Ø¥Ø®Ù„Ø§Ø¡ Ø·Ø¨ÙŠ ÙÙˆØ±ÙŠ (Ø¥Ø³Ø¹Ø§Ù Ù…Ø¯Ø±Ø¹ + Ù…Ø±ÙˆØ­ÙŠØ©)</button>
            <button onclick="handleCmd('field_med')">Ø¥Ø³Ø¹Ø§ÙØ§Øª Ø£ÙˆÙ„ÙŠØ© Ø¯Ø§Ø®Ù„ Ø§Ù„Ø®Ù†Ø§Ø¯Ù‚ + Ø­Ù‚Ù† Ù…ÙˆØ±ÙÙŠÙ†</button>
            <button onclick="handleCmd('report_martyr')">Ø¥Ø¨Ù„Ø§Øº Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø¹Ù† Ø§Ø³ØªØ´Ù‡Ø§Ø¯ Ø¨Ø·Ù„ + Ø¨ÙŠØ§Ù† Ù„Ù„Ø£Ù‡Ù„</button>
            <button onclick="handleCmd('moral_boost')">ØªÙˆØ¬ÙŠÙ‡ ÙƒÙ„Ù…Ø© Ù…Ø¹Ù†ÙˆÙŠØ© Ù„ÙƒÙ„ Ø§Ù„Ø±Ø¬Ø§Ù„Ø© Ø¹Ø¨Ø± Ø§Ù„Ù„Ø§Ø³Ù„ÙƒÙŠ</button>
            <button onclick="handleCmd('casualty_report')">ØªÙ‚Ø±ÙŠØ± Ù…ÙØµÙ„ Ø¹Ù† Ø§Ù„Ø¥ØµØ§Ø¨Ø§Øª ÙˆØ§Ù„Ø´Ù‡Ø¯Ø§Ø¡</button>
        </div>
        
        <!-- Ù‚Ø³Ù… 5 -->
        <div class="command-section">
            <h4>Ù†Ø¯Ø§Ø¡ ÙØ±Ø¯ÙŠ (Ø±Ø§Ø¯ÙŠÙˆ Ø¢Ù…Ù†)</h4>
            <div id="hero-btns" style="max-height:210px; overflow-y:auto;"></div>
        </div>
        
        <!-- Ù‚Ø³Ù… Ø¬Ø¯ÙŠØ¯ 6 - Ø§Ø³ØªØ·Ù„Ø§Ø¹ -->
        <div class="command-section">
            <h4>Ø§Ù„Ø§Ø³ØªØ·Ù„Ø§Ø¹ ÙˆØ§Ù„Ø±Ø§Ø¯Ø§Ø±</h4>
            <button onclick="handleCmd('radar_sweep')">Ù…Ø³Ø­ Ø±Ø§Ø¯Ø§Ø± ÙƒØ§Ù…Ù„ Ù„Ù…Ø³Ø§ÙØ© 8 ÙƒÙ…</button>
            <button onclick="handleCmd('night_vision')">ØªÙØ¹ÙŠÙ„ Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ù„ÙŠÙ„ÙŠØ© Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ø£Ø¨Ø±Ø§Ø¬</button>
            <button onclick="handleCmd('scout_team')">Ø¥Ø±Ø³Ø§Ù„ ÙØ±ÙŠÙ‚ Ø§Ø³ØªØ·Ù„Ø§Ø¹ ØµØºÙŠØ± (3 Ø±Ø¬Ø§Ù„Ø©) Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø²Ø§Ø±Ø¹</button>
            <button onclick="handleCmd('ied_check')">ÙØ­Øµ Ø§Ù„Ø·Ø±Ù‚ Ù…Ù† Ø§Ù„Ø£Ù„ØºØ§Ù… Ø§Ù„Ù…ÙØ®Ø®Ø©</button>
        </div>
    </div>
</div>

<script>
    // ==================== Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙˆØ§Ù‚Ø¹ÙŠØ© ====================
    let resources = {
        ammo: 14500,
        med: 52,
        fuel: 92,
        morale: 88
    };

    let heroes = [
        { name: "Ø£Ø­Ù…Ø¯ ØµØ§Ø¨Ø± Ù…Ù†Ø³ÙŠ", rank: "Ø¹Ù‚ÙŠØ¯ Ø£.Ø­", status: "Ø¬Ø§Ù‡Ø²", health: 100, ammo: 98, fatigue: 8, injury: "", role: "Ù‚Ø§Ø¦Ø¯ Ø§Ù„Ù‚ÙˆØ©", coord: "C2" },
        { name: "Ø£Ø­Ù…Ø¯ Ø§Ù„Ø´Ø¨Ø±Ø§ÙˆÙŠ", rank: "Ù†Ù‚ÙŠØ¨", status: "Ø¬Ø§Ù‡Ø²", health: 100, ammo: 95, fatigue: 12, injury: "", role: "Ø£Ø±ÙƒØ§Ù† Ø­Ø±Ø¨", coord: "D1" },
        { name: "Ø®Ø§Ù„Ø¯ Ù…ØºØ±Ø¨ÙŠ (Ø¯Ø¨Ø§Ø¨Ø©)", rank: "Ù….Ø£ÙˆÙ„", status: "Ø¬Ø§Ù‡Ø²", health: 100, ammo: 100, fatigue: 5, injury: "", role: "Ø®Ø¨ÙŠØ± Ù…ÙØ±Ù‚Ø¹Ø§Øª", coord: "B3" },
        { name: "Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø­Ø³Ù†ÙŠÙ†", rank: "Ù….Ø£ÙˆÙ„", status: "Ø¬Ø§Ù‡Ø²", health: 100, ammo: 92, fatigue: 15, injury: "", role: "Ù‚Ø§Ø¦Ø¯ Ø³Ø±ÙŠØ©", coord: "E4" },
        { name: "Ù…Ø­Ù…Ø¯ Ù…Ø­Ù…ÙˆØ¯ (Ù‡Ø±Ù…)", rank: "Ø¬Ù†Ø¯ÙŠ", status: "Ø¬Ø§Ù‡Ø²", health: 100, ammo: 88, fatigue: 18, injury: "", role: "Ù‚Ù†Ø§Øµ Ø§Ù„ÙØµÙŠÙ„Ø©", coord: "A5" },
        { name: "Ø¹Ù„ÙŠ Ø¹Ù„ÙŠ Ø§Ù„Ø³ÙŠØ¯", rank: "Ø¬Ù†Ø¯ÙŠ", status: "Ø¬Ø§Ù‡Ø²", health: 100, ammo: 97, fatigue: 10, injury: "", role: "Ø­ÙƒÙ…Ø¯Ø§Ø± Ø±Ø´Ø§Ø´", coord: "G2" },
        { name: "Ù…Ø­Ù…Ø¯ Ø¥Ø³Ù…Ø§Ø¹ÙŠÙ„", rank: "Ø¬Ù†Ø¯ÙŠ", status: "Ø¬Ø§Ù‡Ø²", health: 100, ammo: 93, fatigue: 14, injury: "", role: "ØªØ£Ù…ÙŠÙ† Ù…Ù…Ø±Ø§Øª", coord: "F1" },
        { name: "Ø£Ø­Ù…Ø¯ Ø§Ù„Ø¹Ø±Ø¨ÙŠ", rank: "Ø¬Ù†Ø¯ÙŠ", status: "Ø¬Ø§Ù‡Ø²", health: 100, ammo: 96, fatigue: 9, injury: "", role: "Ø­Ø±Ø§Ø³Ø© Ø£Ø¨Ø±Ø§Ø¬", coord: "H3" },
        { name: "Ù…Ø­Ù…Ø¯ ØµÙ„Ø§Ø­ Ø§Ù„Ø¯ÙŠÙ†", rank: "Ø¬Ù†Ø¯ÙŠ", status: "Ø¬Ø§Ù‡Ø²", health: 100, ammo: 90, fatigue: 16, injury: "", role: "ØªØ£Ù…ÙŠÙ† Ø®Ù„ÙÙŠ", coord: "C5" },
        { name: "ÙØ±Ø¬ Ù…Ø­Ù…ÙˆØ¯", rank: "Ø¬Ù†Ø¯ÙŠ", status: "Ø¬Ø§Ù‡Ø²", health: 100, ammo: 94, fatigue: 11, injury: "", role: "Ø³Ø§Ø¦Ù‚ Ù…Ø¯Ø±Ø¹Ø©", coord: "D6" },
        { name: "Ù…Ø¤Ù…Ù† Ø±Ø²Ù‚", rank: "Ø¬Ù†Ø¯ÙŠ", status: "Ø¬Ø§Ù‡Ø²", health: 100, ammo: 99, fatigue: 7, injury: "", role: "ÙÙ†ÙŠ Ø¥Ø´Ø§Ø±Ø©", coord: "B4" },
        { name: "ÙŠØ§Ø³Ø± Ø§Ù„Ø¬Ù†Ø¯ÙŠ", rank: "Ø¬Ù†Ø¯ÙŠ", status: "Ø¬Ø§Ù‡Ø²", health: 100, ammo: 85, fatigue: 20, injury: "", role: "Ù…Ø¯ÙØ¹ÙŠ Ù‡Ø§ÙˆÙ†", coord: "E2" },
        { name: "Ø­Ø³Ø§Ù… Ø¹Ø¨Ø¯ Ø§Ù„Ø±Ø­Ù…Ù†", rank: "Ù†Ù‚ÙŠØ¨", status: "Ø¬Ø§Ù‡Ø²", health: 100, ammo: 96, fatigue: 13, injury: "", role: "Ù‚Ø§Ø¦Ø¯ ÙØµÙŠÙ„Ø©", coord: "G5" }
    ];

    let enemies = [
        { id:1, type: "Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ø´Ø§Ø© RPG-7", initialCount: 18, count: 18, coord: "F3", threat: "Ø¹Ø§Ù„ÙŠ" },
        { id:2, type: "Ù‚Ù†Ø§ØµØ© Ø¹Ù„Ù‰ Ø£Ø³Ø·Ø­ Ø§Ù„Ù…Ø²Ø§Ø±Ø¹", initialCount: 7, count: 7, coord: "H4", threat: "Ù…ØªÙˆØ³Ø·" },
        { id:3, type: "Ø³ÙŠØ§Ø±Ø© Ù…ØµÙØ­Ø© Ø®ÙÙŠÙØ©", initialCount: 4, count: 4, coord: "E5", threat: "Ø¹Ø§Ù„ÙŠ" },
        { id:4, type: "Ù…Ø¬Ù…ÙˆØ¹Ø© Ø±Ø´Ø§Ø´Ø§Øª Ø¯ÙˆØ´ÙƒØ§", initialCount: 11, count: 11, coord: "G6", threat: "Ù…ØªÙˆØ³Ø·" },
        { id:5, type: "Ù…Ø´Ø§Ø© Ù…Ø¹ Ù‚Ù†Ø§Ø¨Ù„ ÙŠØ¯ÙˆÙŠØ©", initialCount: 22, count: 22, coord: "C4", threat: "Ù…Ù†Ø®ÙØ¶" },
        { id:6, type: "Ø¯Ø±Ø§Ø¬Ø§Øª Ù†Ø§Ø±ÙŠØ© Ù…ÙØ®Ø®Ø©", initialCount: 9, count: 9, coord: "D3", threat: "Ø¹Ø§Ù„ÙŠ" },
        { id:7, type: "Ù…Ø¯ÙØ¹ Ù‡Ø§ÙˆÙ† 82mm", initialCount: 3, count: 3, coord: "F2", threat: "Ø¹Ø§Ù„ÙŠ" }
    ];

    let isBattle = false;
    let combatInterval = null;
    let missionSeconds = 0;
    let lastLogTime = Date.now();

    // ==================== Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ­Ø¯ÙŠØ« ====================
    function updateResources() {
        document.getElementById('ammo-val').innerText = resources.ammo.toLocaleString('ar-EG');
        document.getElementById('med-val').innerText = resources.med;
        document.getElementById('fuel-val').innerText = resources.fuel + '%';
        document.getElementById('morale-val').innerText = resources.morale + '%';
        
        // ØªØ­Ø°ÙŠØ±Ø§Øª
        if (resources.ammo < 3000) document.getElementById('ammo-val').style.color = 'var(--warning-orange)';
        if (resources.fuel < 30) document.getElementById('fuel-val').style.color = 'var(--danger-red)';
    }

    function updateHeroesList() {
        const list = document.getElementById('heroes-list');
        list.innerHTML = '';
        let alive = 0;
        
        heroes.forEach(h => {
            if (h.health > 0) alive++;
            let tagClass = h.health <= 0 ? 'tag-dead' : (isBattle ? 'tag-combat' : 'tag-ready');
            let tagText = h.health <= 0 ? 'Ø´Ù‡ÙŠØ¯' : (isBattle ? 'Ø§Ø´ØªØ¨Ø§Ùƒ' : h.status);
            
            let healthColor = h.health > 70 ? 'var(--led-green)' : (h.health > 35 ? 'var(--warning-orange)' : 'var(--danger-red)');
            
            list.innerHTML += `
                <div class="hero-card">
                    <span class="tag ${tagClass}">${tagText}</span>
                    <strong>${h.rank} / ${h.name}</strong><br>
                    <small style="color:#aaa">
                        ${h.role} | Ù…ÙˆÙ‚Ø¹: ${h.coord}<br>
                        ØµØ­Ø©: <span style="color:${healthColor}">${h.health}%</span> | 
                        Ø°Ø®ÙŠØ±Ø©: ${h.ammo}% | Ø¥Ø±Ù‡Ø§Ù‚: ${h.fatigue}%
                    </small>
                    ${h.injury ? `<small style="color:#ff8888">Ø¥ØµØ§Ø¨Ø©: ${h.injury}</small>` : ''}
                </div>
            `;
        });
        document.getElementById('alive-count').innerText = `(${alive}/${heroes.length})`;
    }

    function updateEnemiesList() {
        const list = document.getElementById('enemies-list');
        list.innerHTML = '';
        enemies.forEach(e => {
            if (e.count <= 0) return;
            const threatColor = e.threat === "Ø¹Ø§Ù„ÙŠ" ? "var(--danger-red)" : (e.threat === "Ù…ØªÙˆØ³Ø·" ? "var(--warning-orange)" : "var(--led-green)");
            list.innerHTML += `
                <div class="enemy-card" style="border-color:#550000">
                    <span class="tag" style="background:#550000; color:#fff;">ØªÙ‡Ø¯ÙŠØ¯ ${e.threat}</span>
                    <strong>${e.type}</strong><br>
                    <small style="color:#aaa">
                        Ø¨Ø§Ù‚ÙŠ: <span style="color:var(--danger-red)">${e.count}</span> / ${e.initialCount}<br>
                        Ù…ÙˆÙ‚Ø¹: ${e.coord}
                    </small>
                </div>
            `;
        });
    }

    function initMap() {
        const map = document.getElementById('map');
        map.innerHTML = '';
        const cols = 8;
        const rows = 6;
        
        for (let y = 1; y <= rows; y++) {
            for (let x = 1; x <= cols; x++) {
                const coord = String.fromCharCode(64 + x) + y;
                const cell = document.createElement('div');
                cell.className = 'map-cell';
                cell.dataset.coord = coord;
                cell.innerHTML = `<span class="coord-label">${coord}</span>`;
                
                // Ø­Ø¯Ø« Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø© (Ø±ØµØ¯ ÙÙˆØ±ÙŠ)
                cell.onclick = () => {
                    let msg = `[${new Date().toLocaleTimeString('ar-EG')}] Ø±ØµØ¯ ÙÙˆØ±ÙŠ - Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª <strong>${coord}</strong> `;
                    
                    const hs = heroes.filter(h => h.coord === coord && h.health > 0);
                    const es = enemies.filter(e => e.coord === coord && e.count > 0);
                    
                    if (hs.length > 0) msg += `| Ø£Ø¨Ø·Ø§Ù„: ${hs.map(h => h.name.split(' ').pop()).join('ØŒ ')} `;
                    if (es.length > 0) msg += `| Ø¹Ø¯Ùˆ: ${es.map(e => e.type).join(' + ')} (${es[0].count} ÙØ±Ø¯)`;
                    
                    log(msg, '');
                };
                map.appendChild(cell);
            }
        }
    }

    function updateMap() {
        const cells = document.querySelectorAll('.map-cell');
        cells.forEach(cell => {
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ ÙÙ‚Ø· (Ù†Ø­ØªÙØ¸ Ø¨Ø§Ù„Ù€ label)
            const label = cell.querySelector('.coord-label');
            cell.innerHTML = label ? label.outerHTML : '';
        });
        
        // ÙˆØ¶Ø¹ Ø£Ø¨Ø·Ø§Ù„Ù†Ø§
        heroes.forEach(h => {
            if (h.health <= 0) return;
            const cell = [...cells].find(c => c.dataset.coord === h.coord);
            if (cell) cell.innerHTML += ' <span title="'+h.name+'">ğŸª–</span>';
        });
        
        // ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø¯Ùˆ
        enemies.forEach(e => {
            if (e.count <= 0) return;
            const cell = [...cells].find(c => c.dataset.coord === e.coord);
            if (cell) cell.innerHTML += ' <span title="'+e.type+'" style="color:#ff6666">ğŸ‘¥</span>';
        });
    }

    function updateAllDisplays() {
        updateHeroesList();
        updateEnemiesList();
        updateMap();
        updateResources();
    }

    // ==================== Ø§Ù„Ø³Ø¬Ù„ ====================
    function log(msg, extraClass = '') {
        const term = document.getElementById('terminal');
        const p = document.createElement('p');
        p.className = extraClass;
        p.innerHTML = msg;
        term.appendChild(p);
        term.scrollTop = term.scrollHeight;
        
        // ØµÙˆØª ÙˆÙ‡Ù…ÙŠ Ù„Ù„Ø±Ø§Ø¯ÙŠÙˆ
        if (extraClass.includes('radio-msg') || extraClass.includes('commander-voice')) {
            // ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© ØµÙˆØª Ø­Ù‚ÙŠÙ‚ÙŠ Ù„Ø§Ø­Ù‚Ø§Ù‹
        }
    }

    // ==================== Ø§Ù„Ù†Ø¯Ø§Ø¡ Ø§Ù„ÙØ±Ø¯ÙŠ ====================
    function initHeroBtns() {
        const container = document.getElementById('hero-btns');
        container.innerHTML = '';
        heroes.forEach(h => {
            let btn = document.createElement('button');
            btn.innerText = `Ù†Ø¯Ø§Ø¡: ${h.name.split(' ').pop()}`;
            btn.onclick = () => talkTo(h);
            container.appendChild(btn);
        });
    }

    function talkTo(hero) {
        log(`<span class="commander-voice">Ø§Ù„Ø¹Ù‚ÙŠØ¯ Ù‚Ø§Ø¯Ø±:</span> ÙŠØ§ ${hero.name}.. Ø·Ù…Ù†ÙŠ Ø¹Ù„Ù‰ ÙˆØ¶Ø¹Ùƒ Ø¨Ø§Ù„ØªÙØµÙŠÙ„ ÙŠØ§ Ø¨Ø·Ù„ØŸ`);
        
        setTimeout(() => {
            let responses = [];
            
            if (hero.health <= 25) {
                responses = [
                    `ÙŠØ§ ÙÙ†Ø¯Ù… Ø§Ù†Ø¶Ø±Ø¨Øª ÙÙŠ ÙƒØªÙÙŠ.. Ø§Ù„Ø¯Ù… Ø¨ÙŠØ¬Ø±ÙŠ Ø¨Ø³ Ù„Ø³Ù‡ Ù…Ø§Ø³Ùƒ Ø§Ù„Ø±Ø´Ø§Ø´!`,
                    `ØµØ¹Ø¨Ø© ÙŠØ§ Ù‚Ø§Ø¦Ø¯.. Ø·Ù„Ù‚Ø© ÙÙŠ Ø§Ù„ÙØ®Ø¯.. Ø¨Ø³ Ù‡ÙØ¶Ù„ Ø£ØºØ·ÙŠ Ø§Ù„Ù…Ø¯Ø®Ù„ Ù„Ø­Ø¯ Ø¢Ø®Ø± Ù†ÙØ³!`,
                    `Ø§Ù„Ø¥ØµØ§Ø¨Ø© Ø´Ø¯ÙŠØ¯Ø©.. Ø£Ø­ØªØ§Ø¬ Ø¥Ø®Ù„Ø§Ø¡ ÙÙˆØ±ÙŠ ÙŠØ§ ÙÙ†Ø¯Ù…..`
                ];
            } else if (hero.ammo < 30) {
                responses = [
                    `Ø§Ù„Ø°Ø®ÙŠØ±Ø© Ø®Ù„ØµØª ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹ ÙŠØ§ ÙÙ†Ø¯Ù….. Ø¹Ù†Ø¯ÙŠ Ø¢Ø®Ø± 3 Ù…Ø®Ø§Ø²Ù† Ø¨Ø³!`,
                    `Ø¨Ù†ÙˆÙØ± Ø§Ù„Ø·Ù„Ù‚Ø§Øª.. ÙƒÙ„ Ø±ØµØ§ØµØ© Ù„Ø§Ø²Ù… ØªÙˆØµÙ„!`,
                ];
            } else if (isBattle) {
                responses = [
                    `Ø§Ù„Ø¶Ø±Ø¨ Ù†Ø§Ø± ÙŠØ§ ÙÙ†Ø¯Ù…! Ø§Ù„Ø¹Ø¯Ùˆ Ø¨ÙŠØ­Ø§ÙˆÙ„ ÙŠÙ‚Ø±Ø¨ Ù…Ù† Ø§Ù„Ø³ÙˆØ± Ø§Ù„Ø´Ø±Ù‚ÙŠ.. Ø¨Ù†ØµØ¯Ù‡ Ø¨ÙƒÙ„ Ù‚ÙˆØ©!`,
                    `Ù‚Ù†Ø§ØµØ© ÙÙˆÙ‚ Ø§Ù„Ø¨ÙŠØª Ø§Ù„Ù„ÙŠ Ù‚Ø¯Ø§Ù…Ù†Ø§.. Ù‡Ø±Ù… Ø¨ÙŠØ­Ø§ÙˆÙ„ ÙŠØµØ·Ø§Ø¯Ù‡Ù…!`,
                    `ÙÙŠ Ø¹Ø±Ø¨ÙŠØ© Ù…ØµÙØ­Ø© Ø¨ØªÙ‚Ø±Ø¨ Ù…Ù† Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª D4.. Ø¨Ù†Ø¬Ù‡Ø² RPG!`,
                    `Ø§Ù„Ø±Ø¬Ø§Ù„Ø© ØµØ§Ù…Ø¯ÙŠÙ† ÙŠØ§ Ù‚Ø§Ø¦Ø¯.. Ù…Ø¹Ù†ÙˆÙŠØ§Øª Ø¹Ø§Ù„ÙŠØ© Ø±ØºÙ… Ø§Ù„Ø¶ØºØ·!`,
                    `Ø¯Ù…Ø±Ù†Ø§ 4 Ù…Ù†Ù‡Ù… ÙÙŠ Ø¢Ø®Ø± 3 Ø¯Ù‚Ø§ÙŠÙ‚.. Ù„Ø³Ù‡ Ù…Ø³ØªÙ…Ø±ÙŠÙ†!`
                ];
            } else {
                responses = [
                    `ÙƒÙ„ ØªÙ…Ø§Ù… ÙŠØ§ ÙÙ†Ø¯Ù….. Ø§Ù„Ø±Ø¬Ø§Ù„Ø© ØµØ§Ø­ÙŠØ© 100% ÙˆØ§Ù„Ø£Ø³Ù„Ø­Ø© Ù…Ø¹Ù…Ø±Ø©.`,
                    `Ù…ÙÙŠØ´ Ø­Ø±ÙƒØ© ÙÙŠ Ø§Ù„Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø´Ø±Ù‚ÙŠ.. Ø¨Ù†ØªØ§Ø¨Ø¹ Ø¨Ø§Ù„Ù„ÙŠÙ„ÙŠØ©.`,
                    `Ø§Ù„Ø³ÙˆØ§ØªØ± Ù…Ø£Ù…Ù†Ø© ÙˆØ§Ù„Ø¯ÙˆØ±ÙŠØ§Øª Ø´ØºØ§Ù„Ø© Ø¨Ø§Ù†ØªØ¸Ø§Ù….`,
                    `ÙÙŠ ÙƒÙ„Ø§Ø¨ Ø¶Ø§Ù„Ø© Ø¨Ø³ Ø¨Ù†ØªØ£ÙƒØ¯ Ø¥Ù†Ù‡Ø§ Ù…Ø´ Ù…Ø´Ø¨ÙˆÙ‡Ø©.`
                ];
            }
            
            const resp = responses[Math.floor(Math.random() * responses.length)];
            log(`<span class="radio-msg">Ø§Ù„Ù„Ø§Ø³Ù„ÙƒÙŠ (${hero.name.split(' ').pop()}):</span> ${resp}`);
        }, 1100);
    }

    // ==================== Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ø§Ø´ØªØ¨Ø§Ùƒ Ø§Ù„ÙˆØ§Ù‚Ø¹ÙŠØ© ====================
    function combatTick() {
        if (!isBattle) return;
        
        // Ø§Ø³ØªÙ‡Ù„Ø§Ùƒ Ø°Ø®ÙŠØ±Ø©
        resources.ammo = Math.max(0, resources.ammo - Math.floor(Math.random() * 650) - 380);
        if (resources.ammo < 800 && Math.random() < 0.3) {
            log(`<span style="color:var(--warning-orange)">!!! ØªØ­Ø°ÙŠØ±: Ø§Ù„Ø°Ø®ÙŠØ±Ø© Ø¨ØªÙ†ÙØ¯ Ø¨Ø³Ø±Ø¹Ø© ÙŠØ§ ÙÙ†Ø¯Ù… !!!</span>`);
        }
        updateResources();
        
        // Ø­Ø¯Ø« Ø¹Ø´ÙˆØ§Ø¦ÙŠ (70% Ø§Ø­ØªÙ…Ø§Ù„)
        const rand = Math.random();
        
        if (rand < 0.38) {
            // Ø¥ØµØ§Ø¨Ø© Ø¨Ø·Ù„
            const aliveHeroes = heroes.filter(h => h.health > 0);
            if (aliveHeroes.length > 0) {
                const victim = aliveHeroes[Math.floor(Math.random() * aliveHeroes.length)];
                const dmg = Math.floor(Math.random() * 28) + 8;
                victim.health = Math.max(0, victim.health - dmg);
                victim.fatigue = Math.min(100, victim.fatigue + 9);
                
                const injuryParts = ["Ø§Ù„ÙƒØªÙ Ø§Ù„Ø£ÙŠØ³Ø±", "Ø§Ù„ÙØ®Ø¯ Ø§Ù„Ø£ÙŠÙ…Ù†", "Ø§Ù„ØµØ¯Ø±", "Ø§Ù„Ø°Ø±Ø§Ø¹", "Ø§Ù„Ø±Ø£Ø³ (Ø®ÙÙŠÙ)", "Ø§Ù„Ø³Ø§Ù‚"];
                const injury = injuryParts[Math.floor(Math.random() * injuryParts.length)];
                if (victim.health < 45 && !victim.injury) victim.injury = injury;
                
                log(`<span class="radio-msg">Ø§Ù„Ù„Ø§Ø³Ù„ÙƒÙŠ (${victim.name.split(' ').pop()}):</span> Ø§Ù†Ø¶Ø±Ø¨Øª ÙŠØ§ ÙÙ†Ø¯Ù…! ${dmg}% Ø¥ØµØ§Ø¨Ø© ÙÙŠ ${injury}.. Ù„Ø³Ù‡ ØµØ§Ù…Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø³Ù„Ø§Ø­!`, 'btn-danger');
                
                if (victim.health <= 0) {
                    log(`<span style="color:#ff3131; font-size:1.05em">*** Ø§Ø³ØªØ´Ù‡Ø§Ø¯ Ø§Ù„Ø¨Ø·Ù„ ${victim.name} - Ø±Ø­Ù…Ù‡ Ø§Ù„Ù„Ù‡ ***</span>`, 'btn-danger');
                }
            }
        } 
        else if (rand < 0.72) {
            // ØªØ¯Ù…ÙŠØ± Ø¹Ø¯Ùˆ
            const aliveEnemies = enemies.filter(e => e.count > 0);
            if (aliveEnemies.length > 0) {
                const targetGroup = aliveEnemies[Math.floor(Math.random() * aliveEnemies.length)];
                const kills = Math.floor(Math.random() * 5) + 2;
                targetGroup.count = Math.max(0, targetGroup.count - kills);
                
                log(`<span class="radio-msg">Ø§Ù„Ù„Ø§Ø³Ù„ÙƒÙŠ (Ø§Ù„Ø®Ø· Ø§Ù„Ø£Ù…Ø§Ù…ÙŠ):</span> Ø¯Ù…Ø±Ù†Ø§ ${kills} Ù…Ù† ${targetGroup.type} ÙÙŠ ${targetGroup.coord}! Ù†Ø§Ø± ÙØ¹Ø§Ù„Ø©!`);
            }
        } 
        else if (rand < 0.85) {
            // ØªÙ‚Ø±ÙŠØ± Ù…Ø­Ø§ÙŠØ¯ ÙˆØ§Ù‚Ø¹ÙŠ
            const neutralMsgs = [
                "Ø§Ù„Ø¹Ø¯Ùˆ Ø¨ÙŠØ­Ø§ÙˆÙ„ ÙŠÙ†Ø³Ø­Ø¨ Ù…Ù† Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ø´Ù…Ø§Ù„ÙŠØ©.. Ø¨Ù†ØªØ§Ø¨Ø¹Ù‡Ù…",
                "ÙÙŠ Ø¯Ø®Ø§Ù† ÙƒØ«ÙŠÙ Ù…Ù† Ø§Ù„Ù…Ø²Ø±Ø¹Ø© Ø§Ù„Ù„ÙŠ Ù‚Ø¯Ø§Ù…Ù†Ø§.. ØºØ§Ù„Ø¨Ø§Ù‹ Ø­Ø±ÙŠÙ‚ Ù…Ù† Ù‚Ø°Ø§Ø¦ÙÙ†Ø§",
                "Ø§Ù„Ø±Ø¬Ø§Ù„Ø© Ø·Ø§Ù„Ø¨ÙŠÙ† Ù…ÙŠØ§Ù‡ ÙˆØ°Ø®ÙŠØ±Ø© Ø¥Ø¶Ø§ÙÙŠØ© ÙÙŠ Ø§Ù„Ø®Ù†Ø¯Ù‚ B3",
                "Ù…ÙÙŠØ´ Ø­Ø±ÙƒØ© Ø¬ÙˆÙŠØ© Ù„Ù„Ø¹Ø¯Ùˆ.. Ø§Ù„Ø³Ù…Ø§Ø¡ Ù†Ø¸ÙŠÙØ©"
            ];
            log(`<span class="radio-msg">Ø§Ù„Ù„Ø§Ø³Ù„ÙƒÙŠ:</span> ${neutralMsgs[Math.floor(Math.random()*neutralMsgs.length)]}`);
        }
        
        // ØªØ­Ù‚Ù‚ Ø§Ù„Ù†Ù‡Ø§ÙŠØ©
        const enemiesDead = enemies.every(e => e.count <= 0);
        const heroesDead = heroes.every(h => h.health <= 0);
        
        if (enemiesDead) {
            endBattle(true);
        } else if (heroesDead) {
            endBattle(false);
        } else {
            updateAllDisplays();
        }
    }

    function startBattle() {
        if (isBattle) return;
        isBattle = true;
        document.getElementById('combat-status').innerText = "[ Ø§Ù„Ø­Ø§Ù„Ø©: Ø§Ø´ØªØ¨Ø§Ùƒ Ø¹Ù†ÙŠÙ - Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ù‚ØªØ§Ù„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± ]";
        document.getElementById('combat-status').style.color = "var(--danger-red)";
        
        log("!!! Ø§Ø®ØªØ±Ø§Ù‚ Ø£Ù…Ù†ÙŠ: Ø±ØµØ¯ 40+ Ù‡Ø¯Ù Ù…Ø¹Ø§Ø¯ÙŠ ÙŠØªÙ‚Ø¯Ù…ÙˆÙ† Ù…Ù† Ø§Ù„Ø´Ø±Ù‚.. Ø§Ù„Ø§Ø´ØªØ¨Ø§Ùƒ Ø¨Ø¯Ø£ ÙÙˆØ±Ø§Ù‹!!!", "btn-danger");
        
        heroes.forEach(h => { 
            h.status = "Ø§Ø´ØªØ¨Ø§Ùƒ"; 
            h.fatigue += 12; 
        });
        
        updateAllDisplays();
        
        // Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ©
        combatInterval = setInterval(combatTick, 2600);
        
        // Ø£ÙˆÙ„ ØªÙ‚Ø±ÙŠØ± Ø¨Ø¹Ø¯ 4 Ø«ÙˆØ§Ù†ÙŠ
        setTimeout(() => {
            log(`<span class="radio-msg">Ø§Ù„Ù„Ø§Ø³Ù„ÙƒÙŠ (Ø¹Ù„ÙŠ Ø¹Ù„ÙŠ Ø§Ù„Ø³ÙŠØ¯):</span> ÙŠØ§ ÙÙ†Ø¯Ù… Ø§Ù„Ø¹Ø¯Ùˆ Ø¨ÙŠØ¶Ø±Ø¨ Ù†Ø§Ø± ÙƒØ«ÙŠÙØ© Ù…Ù† 3 Ø§ØªØ¬Ø§Ù‡Ø§Øª.. Ø¨Ù†Ø±Ø¯ Ø¨ÙƒÙ„ Ù‚ÙˆØ©!`, "btn-danger");
        }, 4200);
    }

    function endBattle(victory) {
        isBattle = false;
        if (combatInterval) clearInterval(combatInterval);
        
        const statusEl = document.getElementById('combat-status');
        if (victory) {
            statusEl.innerText = "[ Ø§Ù„Ø­Ø§Ù„Ø©: Ù†Ø¬Ø§Ø­ Ø§Ù„Ù…Ù‡Ù…Ø© - Ø§Ù„Ø¹Ø¯Ùˆ Ù…Ù†Ø³Ø­Ø¨ ]";
            statusEl.style.color = "var(--led-green)";
            log(`<span style="color:var(--led-green); font-size:1.2em">*** Ù…Ø¨Ø±ÙˆÙƒ ÙŠØ§ Ø±Ø¬Ø§Ù„Ø©! ØªÙ… ØªØ·Ù‡ÙŠØ± Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø¨Ø±Ø« Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ ***</span>`);
            resources.morale = Math.min(100, resources.morale + 18);
        } else {
            statusEl.innerText = "[ Ø§Ù„Ø­Ø§Ù„Ø©: Ø§Ù†Ø³Ø­Ø§Ø¨ Ù‚Ø³Ø±ÙŠ - Ø®Ø³Ø§Ø¦Ø± ÙØ§Ø¯Ø­Ø© ]";
            statusEl.style.color = "var(--danger-red)";
            log(`<span style="color:var(--danger-red); font-size:1.2em">*** Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù…Ù‡Ù…Ø© Ø¨Ø®Ø³Ø§Ø¦Ø± ÙƒØ¨ÙŠØ±Ø©.. Ù†Ù†ØªØ¸Ø± ØªØ¹Ø²ÙŠØ²Ø§Øª ***</span>`);
        }
        
        updateAllDisplays();
    }

    // ==================== Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£ÙˆØ§Ù…Ø± ====================
    function handleCmd(type) {
        let commanderMsg = '';
        let extraLog = '';
        
        switch(type) {
            case 'deploy':
                commanderMsg = 'ÙŠØ§ Ø±Ø¬Ø§Ù„Ø©.. ÙƒÙ„ ÙˆØ§Ø­Ø¯ ÙŠØ«Ø¨Øª ÙÙŠ Ù…ÙˆÙ‚Ø¹Ù‡ Ø§Ù„Ù…Ø­Ø¯Ø¯! Ø§Ù„Ø³Ù„Ø§Ø­ Ù…Ø¹Ù…Ø± ÙˆØ§Ù„Ø­ÙŠØ·Ø© ÙˆØ§Ø¬Ø¨Ø©. Ù„Ø§ ØªØªØ±ÙƒÙˆØ§ Ø§Ù„Ø³ÙˆØ±!';
                heroes.forEach(h => h.status = "Ù…Ù†Ø´ÙˆØ±");
                resources.morale = Math.min(100, resources.morale + 3);
                break;
                
            case 'suppression':
                commanderMsg = 'Ø§ÙØªØ­ÙˆØ§ Ø§Ù„Ù†Ø§Ø± Ø¨ÙƒÙ„ Ø§Ù„Ù‚ÙˆØ©! Ù†ÙŠØ±Ø§Ù† ØªØºØ·ÙŠØ© ÙƒØ«ÙŠÙØ© Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ø¬Ø¨Ù‡Ø©!';
                resources.ammo = Math.max(0, resources.ammo - 1850);
                // ØªØ¯Ù…ÙŠØ± Ø³Ø±ÙŠØ¹
                enemies.forEach(e => {
                    if (e.count > 0 && Math.random() < 0.7) e.count = Math.max(0, e.count - Math.floor(Math.random()*4 + 2));
                });
                break;
                
            case 'air_strike':
                if (resources.fuel < 22) {
                    log('ÙˆÙ‚ÙˆØ¯ ØºÙŠØ± ÙƒØ§ÙÙŠ Ù„Ù„Ø·Ø§Ø¦Ø±Ø©! Ø§Ù†ØªØ¸Ø± 8 Ø¯Ù‚Ø§ÙŠÙ‚.', 'btn-danger');
                    return;
                }
                resources.fuel -= 24;
                commanderMsg = 'Ø·Ù„Ø¨ Ø¶Ø±Ø¨Ø© Ø¬ÙˆÙŠØ© Ø¯Ù‚ÙŠÙ‚Ø© Ø¹Ù„Ù‰ Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø¹Ø¯Ùˆ.. Ø§Ù„Ø·ÙŠØ§Ø± ÙÙŠ Ø§Ù„Ø·Ø±ÙŠÙ‚!';
                setTimeout(() => {
                    const hits = Math.floor(Math.random() * 16) + 11;
                    let remainingHits = hits;
                    enemies.forEach(e => {
                        if (remainingHits > 0 && e.count > 0) {
                            const k = Math.min(remainingHits, Math.floor(Math.random()*7) + 3);
                            e.count = Math.max(0, e.count - k);
                            remainingHits -= k;
                        }
                    });
                    log(`<span class="radio-msg">Ø§Ù„Ø·ÙŠØ§Ø± (F-16):</span> Ø¶Ø±Ø¨Ø© Ù†Ø§Ø¬Ø­Ø©! ${hits} Ù‡Ø¯Ù Ù…Ø¯Ù…Ø± ØªÙ…Ø§Ù…Ø§Ù‹. Over and out.`);
                    updateAllDisplays();
                }, 2100);
                break;
                
            case 'drone_scan':
                commanderMsg = 'ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¯Ø±ÙˆÙ† Ø§Ù„Ø§Ø³ØªØ·Ù„Ø§Ø¹ÙŠ Ø­Ø§Ù„Ø§.. ØµÙˆØ± Ø­ÙŠØ© Ù„Ù„Ù‚Ø·Ø§Ø¹ ÙƒÙ„Ù‡.';
                setTimeout(() => {
                    const sighted = enemies[Math.floor(Math.random() * enemies.length)];
                    log(`<span class="radio-msg">Ø§Ù„Ø¯Ø±ÙˆÙ†:</span> Ø±ØµØ¯Øª ${sighted.count} ${sighted.type} ÙÙŠ ${sighted.coord}.. ØªÙ‡Ø¯ÙŠØ¯ ${sighted.threat}. ØµÙˆØ± Ù…Ø±ÙÙ‚Ø©.`);
                }, 1700);
                break;
                
            case 'report_martyr':
                const deadHero = heroes.find(h => h.health <= 0) || heroes[Math.floor(Math.random()*heroes.length)];
                commanderMsg = `Ø¹Ù…Ù„ÙŠØ§Øª.. Ø¨Ù„ØºÙˆØ§ Ø§Ù„Ø£Ù‡Ù„.. Ø§Ù„Ø¨Ø·Ù„ ${deadHero.name} Ø§Ø³ØªØ´Ù‡Ø¯ ÙˆÙ‡Ùˆ Ù…Ù‚Ø¨Ù„ ØºÙŠØ± Ù…Ø¯Ø¨Ø±.`;
                if (deadHero.health > 0) deadHero.health = 0;
                break;
                
            case 'apache_cover':
                commanderMsg = 'Ù…Ø­ØªØ§Ø¬ÙŠÙ† ØºØ·Ø§Ø¡ Ø£Ø¨Ø§ØªØ´ÙŠ Ù…Ø³ØªÙ…Ø± ÙÙˆÙ‚ Ø§Ù„Ø®Ø· Ø§Ù„Ø£Ù…Ø§Ù…ÙŠ Ø­Ø§Ù„Ø§!';
                resources.fuel -= 12;
                setTimeout(() => {
                    log(`<span class="radio-msg">Ø§Ù„Ø£Ø¨Ø§ØªØ´ÙŠ:</span> Ù…ÙˆØ¬ÙˆØ¯ ÙÙˆÙ‚ÙƒÙ….. Ø¨Ù†ÙØªØ­ Ù†Ø§Ø± Ø¹Ù„Ù‰ ÙƒÙ„ ØªØ­Ø±Ùƒ Ù…Ø¹Ø§Ø¯ÙŠ.`);
                    enemies.forEach(e => { if (Math.random() < 0.6) e.count = Math.max(0, e.count - 3); });
                }, 2400);
                break;
                
            case 'moral_boost':
                commanderMsg = 'ÙŠØ§ Ø£Ø¨Ø·Ø§Ù„ Ù…ØµØ±.. Ø£Ù†ØªÙ… Ø­Ù…Ø§Ø© Ø§Ù„ÙˆØ·Ù†! ÙƒÙ„ ÙˆØ§Ø­Ø¯ Ù…Ù†ÙƒÙ… Ø¨Ø·Ù„.. ØµØ§Ù…Ø¯ÙˆÙ† Ø­ØªÙ‰ Ø§Ù„Ù†ØµØ±!';
                resources.morale = Math.min(100, resources.morale + 14);
                break;
                
            case 'evac_injured':
                commanderMsg = 'Ø·Ù„Ø¨ Ø¥Ø®Ù„Ø§Ø¡ Ø·Ø¨ÙŠ ÙÙˆØ±ÙŠ Ù„Ù„Ø¬Ø±Ø­Ù‰.. Ø§Ù„Ø¥Ø³Ø¹Ø§Ù Ø§Ù„Ù…Ø¯Ø±Ø¹ ÙÙŠ Ø§Ù„Ø·Ø±ÙŠÙ‚!';
                resources.med = Math.max(0, resources.med - 8);
                // ØªØ­Ø³ÙŠÙ† ØµØ­Ø© Ø¨Ø¹Ø¶ Ø§Ù„Ø¬Ø±Ø­Ù‰
                heroes.forEach(h => {
                    if (h.health > 0 && h.health < 50) h.health = Math.min(100, h.health + 22);
                });
                break;
                
            default:
                commanderMsg = `Ø£Ù…Ø± Ø¨ØªÙ†ÙÙŠØ°: ${type.replace(/_/g, ' ')}... Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙ†ÙÙŠØ° Ø¹Ù„Ù‰ Ø§Ù„ÙÙˆØ±.`;
        }
        
        if (commanderMsg) log(`<span class="commander-voice">Ø§Ù„Ø¹Ù‚ÙŠØ¯ Ù‚Ø§Ø¯Ø±:</span> ${commanderMsg}`);
        if (extraLog) log(extraLog);
        
        updateAllDisplays();
    }

    // ==================== Ø§Ù„Ø³Ø§Ø¹Ø§Øª ====================
    function startClocks() {
        setInterval(() => {
            document.getElementById('clock').innerText = new Date().toLocaleTimeString('ar-EG');
        }, 1000);
        
        setInterval(() => {
            missionSeconds++;
            const mins = Math.floor(missionSeconds / 60);
            const secs = missionSeconds % 60;
            document.getElementById('mission-timer').innerText = 
                `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }, 1000);
    }

    // ==================== Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø© ====================
    function initGame() {
        initMap();
        updateAllDisplays();
        initHeroBtns();
        startClocks();
        
        // Ø­Ø¯Ø« Ø¹Ø´ÙˆØ§Ø¦ÙŠ ÙƒÙ„ 35 Ø«Ø§Ù†ÙŠØ© ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ù‡Ø¯ÙˆØ¡
        setInterval(() => {
            if (!isBattle && Math.random() < 0.6) {
                const randEvent = [
                    "Ø±ØµØ¯ ØªØ­Ø±Ùƒ Ù…Ø´Ø¨ÙˆÙ‡ ÙÙŠ Ø§Ù„Ù…Ø²Ø±Ø¹Ø© Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠØ©.. Ù†ØªØ§Ø¨Ø¹Ù‡",
                    "ÙƒÙ„Ø§Ø¨ Ø¶Ø§Ù„Ø© Ù‚Ø±ÙŠØ¨Ø© Ù…Ù† Ø§Ù„Ø³ÙˆØ±.. ØªÙ… Ø¥Ø·Ù„Ø§Ù‚ Ø·Ù„Ù‚Ø© ØªØ­Ø°ÙŠØ±ÙŠØ©",
                    "Ø§Ù„Ø·Ù‚Ø³: Ø±ÙŠØ§Ø­ Ø®ÙÙŠÙØ©.. Ø§Ù„Ø±Ø¤ÙŠØ© Ø¬ÙŠØ¯Ø©",
                    "Ø§Ù„Ø±Ø¬Ø§Ù„Ø© Ø·Ø§Ù„Ø¨ÙŠÙ† Ù‚Ù‡ÙˆØ© Ø³Ø§Ø¯Ø© ÙŠØ§ ÙÙ†Ø¯Ù… ğŸ˜„"
                ];
                log(`<span style="color:#888">[ØªÙ‚Ø±ÙŠØ± ØªÙ„Ù‚Ø§Ø¦ÙŠ]</span> ${randEvent[Math.floor(Math.random()*randEvent.length)]}`);
            }
        }, 35000);
        
        log('<span style="color:var(--desert-yellow)">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙŠØ§ Ø¹Ù‚ÙŠØ¯ Ù‚Ø§Ø¯Ø±.. Ù…Ø±ÙƒØ² Ø§Ù„Ù‚ÙŠØ§Ø¯Ø© Ø¬Ø§Ù‡Ø² 100%. Ø§Ø®ØªØ± Ø£Ù…Ø±Ùƒ.</span>');
    }

    // ØªØ´ØºÙŠÙ„ Ø§Ù„Ù„Ø¹Ø¨Ø©
    window.onload = initGame;
</script>
</body>
</html>
